<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartAlgo V9 - Market Psychology</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* CONFIGURATION */
        :root { 
            --bg-main: #0E1117; 
            --bg-card: #161A25; 
            --border: #2B3139; 
            --up: #0ECB81; 
            --down: #F6465D; 
            --text-main: #EAECEF;
            --text-sub: #848E9C;
        }
        
        body { background-color: var(--bg-main); color: var(--text-main); font-family: 'Inter', sans-serif; overflow: hidden; user-select: none; }
        .mono { font-family: 'Roboto Mono', monospace; }
        .border-c { border-color: var(--border); }
        .bg-card { background-color: var(--bg-card); }
        
        /* UTILS */
        .text-up { color: var(--up); } .text-down { color: var(--down); }
        .bg-up { background-color: var(--up); } .bg-down { background-color: var(--down); }
        
        /* ANIMATIONS & BARS */
        .depth-ask { position: absolute; top:0; left:0; height:100%; background: rgba(246, 70, 93, 0.12); z-index:0; transition: width 0.2s; }
        .depth-bid { position: absolute; top:0; right:0; height:100%; background: rgba(14, 203, 129, 0.12); z-index:0; transition: width 0.2s; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg-main); }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }

        /* SENTIMENT METER */
        .meter-container { width: 100%; height: 4px; background: #333; border-radius: 2px; overflow: hidden; margin-top: 4px; position: relative; }
        .meter-fill { height: 100%; transition: width 0.5s, background-color 0.5s; }
        .needle { position: absolute; top: -2px; width: 2px; height: 8px; background: #fff; transition: left 0.5s; z-index: 10; }

        /* TOAST */
        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 4px; padding: 12px; position: fixed; z-index: 99; left: 50%; top: 20px; transform: translateX(-50%); font-size: 13px; opacity: 0; transition: opacity 0.3s; }
        #toast.show { visibility: visible; opacity: 1; }
    </style>
</head>
<body class="flex flex-col h-screen w-screen text-[13px]">

    <header class="h-16 bg-card border-b border-c flex items-center justify-between px-4 shrink-0 shadow-lg z-20">
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-blue-600 rounded flex items-center justify-center font-bold text-white">S</div>
                <div class="flex flex-col">
                    <span class="text-[10px] text-sub font-bold uppercase">Active Asset</span>
                    <select id="asset-select" onchange="APP.changeAsset()" class="bg-[#0E1117] border border-c text-white text-xs font-bold p-1 rounded outline-none cursor-pointer">
                        <option value="BTC">BITCOIN (BTC/USD)</option>
                        <option value="BBCA">BCA (BBCA.JK)</option>
                    </select>
                </div>
            </div>

            <div class="flex flex-col min-w-[140px]">
                <span class="text-[10px] text-sub font-bold uppercase">Last Price</span>
                <span class="text-xl font-bold mono transition-colors" id="head-price">0.00</span>
            </div>

            <div class="flex flex-col w-[200px]">
                <div class="flex justify-between text-[9px] font-bold uppercase mb-1">
                    <span class="text-down">Extreme Fear</span>
                    <span class="text-white" id="sentiment-text">Neutral</span>
                    <span class="text-up">Extreme Greed</span>
                </div>
                <div class="meter-container">
                    <div class="meter-fill" id="meter-bar" style="width: 50%; background: #fbbf24;"></div>
                    <div class="needle" id="meter-needle" style="left: 50%;"></div>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-6 text-right">
            <div onclick="APP.setBalance()" class="cursor-pointer hover:opacity-80">
                <span class="text-[10px] text-sub font-bold uppercase">Balance (Click to Set)</span>
                <div class="font-bold mono text-yellow-500 text-sm" id="head-cash">0</div>
            </div>
            <div>
                <span class="text-[10px] text-sub font-bold uppercase">Unrealized P/L</span>
                <div class="font-bold mono text-sm" id="head-pl">0</div>
            </div>
            <div>
                 <span class="text-[10px] text-sub font-bold uppercase">Position</span>
                 <div class="font-bold mono text-blue-400 text-sm" id="head-pos">0</div>
            </div>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden">
        
        <div class="flex-1 flex flex-col min-w-0 bg-main relative border-r border-c">
            <div class="absolute top-2 left-2 z-10 flex gap-2">
                <button onclick="CHART.setTf(1)" class="bg-card border border-c px-2 py-1 rounded text-[10px] hover:bg-gray-700">1m</button>
                <button onclick="CHART.setTf(5)" class="bg-card border border-c px-2 py-1 rounded text-[10px] hover:bg-gray-700">5m</button>
                <div class="flex items-center gap-1 bg-black/40 px-2 rounded border border-c">
                    <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                    <span class="text-[10px] text-sub">LIVE</span>
                </div>
            </div>
            <canvas id="mainChart" class="block w-full h-full cursor-crosshair"></canvas>
        </div>

        <div class="w-[380px] flex flex-col bg-card shrink-0 border-l border-c">
            
            <div class="h-[45%] flex flex-col border-b border-c">
                <div class="px-3 py-2 border-b border-c bg-[#11141B] flex justify-between">
                    <span class="text-[10px] font-bold text-sub uppercase">Order Book</span>
                    <span class="text-[10px] font-bold text-sub" id="spread-val">Spread: 0</span>
                </div>
                <div class="grid grid-cols-3 text-[9px] text-sub font-bold px-2 py-1">
                    <span>BID SIZE</span><span class="text-center">PRICE</span><span class="text-right">ASK SIZE</span>
                </div>
                <div id="book-container" class="flex-1 overflow-y-auto relative bg-main font-mono"></div>
            </div>

            <div class="h-[25%] flex flex-col border-b border-c">
                <div class="px-3 py-2 border-b border-c bg-[#11141B]">
                    <span class="text-[10px] font-bold text-sub uppercase">Recent Trades</span>
                </div>
                <div id="tape-container" class="flex-1 overflow-y-auto font-mono text-[10px] bg-main"></div>
            </div>

            <div class="flex-1 p-3 flex flex-col gap-2 overflow-y-auto bg-card">
                <div class="flex justify-between text-[10px] bg-main p-2 rounded border border-c">
                    <span class="text-sub">Avg Entry: <span id="lbl-avg" class="text-white font-mono">0</span></span>
                    <span class="text-sub">Asset: <span id="lbl-asset" class="text-white font-bold">BTC</span></span>
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="text-[9px] text-sub font-bold block mb-1">AMOUNT</label>
                        <input type="number" id="input-lot" class="w-full bg-main border border-c text-white p-2 text-center font-mono font-bold rounded focus:border-blue-500 outline-none" placeholder="Qty">
                    </div>
                     <div>
                        <label class="text-[9px] text-sub font-bold block mb-1">SMART TOOLS</label>
                        <select id="smart-tool" class="w-full bg-main border border-c text-white text-[10px] p-2 rounded outline-none">
                            <option value="none">Manual Mode</option>
                            <option value="auto">ü§ñ Bot Haka/Haki</option>
                            <option value="wash">üåÄ Wash Trade (Fake Vol)</option>
                            <option value="fake">‚ö†Ô∏è Fakeout (Trap)</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-2 mt-1">
                    <button onclick="APP.execute('BUY')" class="bg-up hover:brightness-110 text-white font-bold py-3 rounded text-sm transition shadow-lg shadow-green-900/20 active:scale-95">
                        BUY / LONG
                    </button>
                    <button onclick="APP.execute('SELL')" class="bg-down hover:brightness-110 text-white font-bold py-3 rounded text-sm transition shadow-lg shadow-red-900/20 active:scale-95">
                        SELL / SHORT
                    </button>
                </div>
                
                <div class="mt-2 text-[9px] text-center text-sub italic">
                    *Tip: Buy when Fear (Red), Sell when Greed (Green)
                </div>
            </div>
        </div>
    </div>

    <div id="toast">Notification</div>

<script>
/**
 * SMARTALGO PRO V9 - PSYCHOLOGY ENGINE
 */

const $ = (id) => document.getElementById(id);
const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
const randFloat = (min, max) => (Math.random() * (max - min) + min).toFixed(4);

// --- ASSET CONFIGURATION ---
const ASSETS = {
    BTC: {
        name: 'Bitcoin',
        ticker: 'BTC/USD',
        price: 96500.00,
        tick: 1.00,
        volDecimals: 4,
        minVol: 0.01,
        maxVol: 2.5,
        currency: '$'
    },
    BBCA: {
        name: 'Bank Central Asia',
        ticker: 'BBCA.JK',
        price: 10250,
        tick: 25,
        volDecimals: 0, // Lots
        minVol: 1,
        maxVol: 500,
        currency: 'Rp'
    }
};

// --- CORE STATE ---
const STATE = {
    active: 'BTC', // BTC or BBCA
    price: 0,
    cash: 50000, // USD for BTC, IDR for BCA (will adjust on switch)
    portfolio: { pos: 0, avg: 0 },
    
    // Psychology
    sentiment: 50, // 0 (Fear) - 100 (Greed)
    momentum: 0,
    
    // Market Data
    bids: [], asks: [], trades: [],
    candles: [],
    
    // System
    botInterval: null
};

// --- CHART ENGINE ---
const CHART = {
    canvas: $('mainChart'),
    ctx: $('mainChart').getContext('2d'),
    data: [],
    tf: 1, // min
    
    init() {
        this.resize();
        window.onresize = () => this.resize();
        this.resetHistory();
        this.loop();
    },
    resize() {
        this.canvas.width = this.canvas.parentElement.clientWidth;
        this.canvas.height = this.canvas.parentElement.clientHeight;
    },
    resetHistory() {
        this.data = [];
        let p = STATE.price;
        let t = Date.now() - (60 * 60000);
        // Pre-fill
        for(let i=0; i<60; i++) {
            let change = (Math.random()-0.5) * (STATE.active === 'BTC' ? 100 : 50);
            let c = p + change;
            this.data.push({time: t + (i*60000), o:p, h:Math.max(p,c), l:Math.min(p,c), c:c});
            p = c;
        }
        STATE.price = p; // Sync start price
    },
    update(price) {
        let last = this.data[this.data.length-1];
        let now = Date.now();
        if(now - last.time > this.tf * 60000) {
            this.data.push({time: now, o:price, h:price, l:price, c:price});
            if(this.data.length > 80) this.data.shift();
        } else {
            last.c = price;
            if(price > last.h) last.h = price;
            if(price < last.l) last.l = price;
        }
    },
    loop() {
        requestAnimationFrame(() => this.loop());
        const ctx = this.ctx;
        const w = this.canvas.width, h = this.canvas.height;
        
        ctx.fillStyle = '#0E1117'; ctx.fillRect(0,0,w,h);
        
        // Grid
        ctx.strokeStyle = '#1e2329'; ctx.lineWidth = 1;
        ctx.beginPath(); for(let i=0; i<h; i+=50){ctx.moveTo(0,i);ctx.lineTo(w,i);} ctx.stroke();

        let vals = this.data.map(d=>[d.h, d.l]).flat();
        let min = Math.min(...vals); let max = Math.max(...vals);
        let padding = (max - min) * 0.1;
        min -= padding; max += padding;
        const range = max - min || 1;
        
        const getY = p => h - ((p-min)/range)*h;
        const barW = (w-20) / this.data.length;

        this.data.forEach((d,i) => {
            let x = 10 + (i*barW);
            let isUp = d.c >= d.o;
            let col = isUp ? '#0ECB81' : '#F6465D';
            ctx.fillStyle = col; ctx.strokeStyle = col;
            
            ctx.beginPath(); ctx.moveTo(x+barW/2, getY(d.h)); ctx.lineTo(x+barW/2, getY(d.l)); ctx.stroke();
            let bH = Math.max(1, Math.abs(getY(d.o)-getY(d.c)));
            ctx.fillRect(x+1, getY(Math.max(d.o, d.c)), barW-2, bH);
        });

        // Price Line
        let py = getY(STATE.price);
        ctx.strokeStyle = '#fff'; ctx.setLineDash([2,4]);
        ctx.beginPath(); ctx.moveTo(0, py); ctx.lineTo(w, py); ctx.stroke(); ctx.setLineDash([]);
        
        // Label
        ctx.fillStyle = '#fff'; ctx.font = '10px Roboto Mono';
        ctx.fillText(STATE.price.toFixed(STATE.active==='BTC'?2:0), w-60, py-5);
    },
    setTf(m) { this.tf = m; }
};

// --- APP ENGINE ---
const APP = {
    init() {
        // Init Asset
        this.changeAsset();
        CHART.init();
        
        // Loops
        this.renderLoop();
        setInterval(() => this.updatePsychology(), 1000); // Sentiment updates
        setInterval(() => this.generateBotTraffic(), 400); // Market Makers
    },

    changeAsset() {
        const val = $('asset-select').value;
        STATE.active = val;
        const cfg = ASSETS[val];
        
        STATE.price = cfg.price;
        STATE.portfolio = { pos: 0, avg: 0 };
        STATE.cash = val === 'BTC' ? 50000 : 100000000; // Reset cash context
        
        // Reset Book
        this.resetBook();
        
        if(CHART.data) CHART.resetHistory();
        
        $('lbl-asset').innerText = val;
        $('input-lot').value = val === 'BTC' ? 0.5 : 100;
        $('input-lot').step = val === 'BTC' ? 0.01 : 1;
        
        this.showToast(`Switched to ${cfg.name}`);
    },

    resetBook() {
        const cfg = ASSETS[STATE.active];
        STATE.asks = []; STATE.bids = [];
        for(let i=0; i<15; i++) {
            let vol = STATE.active === 'BTC' 
                ? parseFloat((Math.random() * 2).toFixed(4)) 
                : Math.floor(Math.random() * 500) + 10;
            
            STATE.asks.push({price: STATE.price + ((i+1)*cfg.tick), vol: vol});
            STATE.bids.push({price: STATE.price - ((i)*cfg.tick), vol: vol});
        }
    },

    setBalance() {
        let n = prompt("Set New Balance:", STATE.cash);
        if(n && !isNaN(n)) STATE.cash = parseFloat(n);
    },

    // --- PSYCHOLOGY ENGINE ---
    updatePsychology() {
        // Random Walk Sentiment
        let drift = (Math.random() - 0.5) * 5;
        STATE.sentiment += drift;
        
        // Logic: Price drop creates fear, Rise creates greed
        let lastC = CHART.data[CHART.data.length-1];
        if(lastC) {
            if(lastC.c < lastC.o) STATE.sentiment -= 2;
            else STATE.sentiment += 2;
        }

        // Clamp
        if(STATE.sentiment > 100) STATE.sentiment = 100;
        if(STATE.sentiment < 0) STATE.sentiment = 0;

        // Visuals
        const meter = $('meter-bar');
        const needle = $('meter-needle');
        const txt = $('sentiment-text');
        
        needle.style.left = STATE.sentiment + "%";
        
        if(STATE.sentiment > 70) {
            meter.style.background = '#0ECB81'; // Greed
            txt.innerText = "GREED (Retail FOMO)";
            txt.className = "text-up font-bold uppercase";
        } else if(STATE.sentiment < 30) {
            meter.style.background = '#F6465D'; // Fear
            txt.innerText = "FEAR (Panic Sell)";
            txt.className = "text-down font-bold uppercase";
        } else {
            meter.style.background = '#fbbf24'; // Neutral
            txt.innerText = "NEUTRAL";
            txt.className = "text-white font-bold uppercase";
        }
    },

    // --- MARKET MAKER BOT ---
    generateBotTraffic() {
        const cfg = ASSETS[STATE.active];
        
        // BOT LOGIC BASED ON SENTIMENT
        // If Extreme Greed (>80), Retail buys, Whales Sell
        // If Extreme Fear (<20), Retail sells, Whales Buy
        
        let buyProb = 0.5;
        if(STATE.sentiment > 80) buyProb = 0.7; // Retail FOMO pushing up
        if(STATE.sentiment < 20) buyProb = 0.3; // Retail Panic dumping
        
        let side = Math.random() < buyProb ? 'BUY' : 'SELL';
        
        // Volume
        let vol = STATE.active === 'BTC' 
            ? parseFloat((Math.random() * cfg.maxVol).toFixed(cfg.volDecimals))
            : Math.floor(Math.random() * cfg.maxVol);
        
        if(vol <= 0) vol = cfg.minVol;

        // Auto Tools Logic
        const tool = $('smart-tool').value;
        if(tool === 'auto') {
            // User Bot overrides market
            this.execute(Math.random() > 0.5 ? 'BUY' : 'SELL', null, false); // Fast execution
        } else if (tool === 'fake' && Math.random() < 0.1) {
             // Fakeout bot injection
             side = side === 'BUY' ? 'SELL' : 'BUY'; // Counter trend
             vol *= 3; // Huge vol
        }

        this.matchOrder(side, vol, false);

        // Replenish Books (Liquidity Providers)
        if(Math.random() < 0.4) {
             let idx = rand(0, 5);
             if(STATE.active === 'BTC') {
                 STATE.asks[idx].vol += parseFloat(Math.random().toFixed(2));
                 STATE.bids[idx].vol += parseFloat(Math.random().toFixed(2));
             } else {
                 STATE.asks[idx].vol += rand(10, 50);
                 STATE.bids[idx].vol += rand(10, 50);
             }
        }
    },

    // --- EXECUTION ENGINE ---
    execute(side, qtyOverride = null, isUser = true) {
        let qty = qtyOverride || parseFloat($('input-lot').value);
        if(qty <= 0) return;

        // Smart Tools Injection
        const tool = $('smart-tool').value;
        if(isUser && tool === 'wash') {
            // Wash Trade: No portfolio impact, just volume
            this.showToast("Washing Volume...");
            this.matchOrder('BUY', qty, false);
            setTimeout(() => this.matchOrder('SELL', qty, false), 100);
            return;
        }

        // Validate Balance/Pos for User
        const cfg = ASSETS[STATE.active];
        if(isUser) {
            let estVal = STATE.asks[0].price * qty * (STATE.active==='BBCA'?100:1);
            if(side === 'BUY' && STATE.cash < estVal) return this.showToast("INSUFFICIENT FUNDS", "error");
            if(side === 'SELL' && STATE.portfolio.pos < qty) return this.showToast("NO POSITION TO SELL", "error");
        }

        this.matchOrder(side, qty, isUser);
    },

    matchOrder(side, vol, isUser) {
        let remaining = vol;
        let books = side === 'BUY' ? STATE.asks : STATE.bids;
        let filled = 0;
        let totalCost = 0;
        let cfg = ASSETS[STATE.active];

        while(remaining > 0 && books.length > 0) {
            let best = books[0];
            let tradeVol = Math.min(remaining, best.vol);
            
            // Logic: Price moves only if level consumed
            STATE.price = best.price;
            CHART.update(STATE.price);

            best.vol -= tradeVol;
            // Fix float precision for BTC
            if(STATE.active === 'BTC') best.vol = parseFloat(best.vol.toFixed(4));
            
            remaining -= tradeVol;
            filled += tradeVol;
            
            // Calc Cost (BBCA 1 Lot = 100 shares)
            let multiplier = STATE.active === 'BBCA' ? 100 : 1;
            totalCost += (best.price * tradeVol * multiplier);

            // Tape
            STATE.trades.unshift({
                time: new Date().toLocaleTimeString().split(' ')[0], 
                price: best.price, 
                vol: tradeVol, 
                side: side
            });
            if(STATE.trades.length > 30) STATE.trades.pop();

            // Level Clear?
            if(best.vol <= cfg.minVol/10) {
                books.shift();
                // Add new depth
                let lastP = books.length > 0 ? books[books.length-1].price : STATE.price;
                let newP = side === 'BUY' ? lastP + cfg.tick : lastP - cfg.tick;
                let newVol = STATE.active==='BTC' ? parseFloat((Math.random()*2).toFixed(4)) : rand(10,500);
                books.push({price: newP, vol: newVol});
            }
        }

        if(isUser && filled > 0) this.updatePorto(side, filled, totalCost);
    },

    updatePorto(side, vol, cost) {
        const P = STATE.portfolio;
        if(side === 'BUY') {
            STATE.cash -= cost;
            // Weighted Avg
            let prevVal = P.pos * P.avg * (STATE.active==='BBCA'?100:1);
            P.pos += vol;
            if(STATE.active==='BTC') P.pos = parseFloat(P.pos.toFixed(4));
            
            let multiplier = STATE.active==='BBCA'?100:1;
            P.avg = (prevVal + cost) / (P.pos * multiplier);
            
        } else {
            STATE.cash += cost;
            P.pos -= vol;
            if(STATE.active==='BTC') P.pos = parseFloat(P.pos.toFixed(4));
            if(P.pos <= 0.0001) { P.pos = 0; P.avg = 0; }
        }
    },

    // --- UI ---
    renderLoop() {
        requestAnimationFrame(() => this.renderLoop());
        const cfg = ASSETS[STATE.active];
        const decimals = STATE.active === 'BTC' ? 2 : 0;
        const volDec = cfg.volDecimals;

        // 1. Header
        $('head-price').innerText = STATE.price.toFixed(decimals);
        $('head-price').className = `text-xl font-bold mono transition-colors ${STATE.price > CHART.data[0]?.o ? 'text-up' : 'text-down'}`;
        $('head-cash').innerText = cfg.currency + " " + STATE.cash.toLocaleString(undefined, {maximumFractionDigits: 0});
        $('head-pos').innerText = STATE.portfolio.pos + (STATE.active==='BBCA'?' Lot':' BTC');
        
        let multiplier = STATE.active==='BBCA'?100:1;
        let pl = (STATE.price - STATE.portfolio.avg) * STATE.portfolio.pos * multiplier;
        $('head-pl').innerText = cfg.currency + " " + pl.toLocaleString(undefined, {maximumFractionDigits:0});
        $('head-pl').className = `font-bold mono text-sm ${pl>=0 ? 'text-up':'text-down'}`;

        $('lbl-avg').innerText = STATE.portfolio.avg.toFixed(decimals);

        // 2. Book
        const bEl = $('book-container');
        let html = '';
        // Asks
        STATE.asks.slice(0,8).reverse().forEach(a => {
            let w = Math.min((a.vol/cfg.maxVol)*100, 100);
            html += `<div class="grid grid-cols-3 px-2 py-0.5 relative hover:bg-white/5 cursor-pointer" onclick="APP.execute('BUY', ${a.vol})">
                <div class="depth-ask" style="width:${w}%"></div>
                <span class="text-sub z-10">-</span>
                <span class="text-down text-center z-10 font-bold">${a.price.toFixed(decimals)}</span>
                <span class="text-sub text-right z-10 font-mono">${a.vol.toFixed(volDec)}</span>
            </div>`;
        });
        // Spread
        let spread = STATE.asks[0].price - STATE.bids[0].price;
        html += `<div class="text-center text-[9px] text-sub py-0.5 border-y border-c bg-black/20">Spread: ${spread.toFixed(decimals)}</div>`;
        // Bids
        STATE.bids.slice(0,8).forEach(b => {
            let w = Math.min((b.vol/cfg.maxVol)*100, 100);
            html += `<div class="grid grid-cols-3 px-2 py-0.5 relative hover:bg-white/5 cursor-pointer" onclick="APP.execute('SELL', ${b.vol})">
                <div class="depth-bid" style="width:${w}%"></div>
                <span class="text-sub z-10 font-mono">${b.vol.toFixed(volDec)}</span>
                <span class="text-up text-center z-10 font-bold">${b.price.toFixed(decimals)}</span>
                <span class="text-sub text-right z-10">-</span>
            </div>`;
        });
        bEl.innerHTML = html;

        // 3. Tape
        const tEl = $('tape-container');
        let tHtml = '';
        STATE.trades.forEach(t => {
            let col = t.side === 'BUY' ? 'text-up' : 'text-down';
            tHtml += `<div class="grid grid-cols-3 px-2 border-b border-c py-0.5">
                <span class="text-sub">${t.time}</span>
                <span class="${col} text-center font-bold">${t.price.toFixed(decimals)}</span>
                <span class="text-right text-sub">${t.vol.toFixed(volDec)}</span>
            </div>`;
        });
        tEl.innerHTML = tHtml;
    },

    showToast(msg, type) {
        const t = $('toast');
        t.innerText = msg;
        t.style.background = type === 'error' ? '#F6465D' : '#333';
        t.className = "show";
        setTimeout(() => t.className = "", 3000);
    }
};

window.onload = () => APP.init();

</script>
</body>
</html>
